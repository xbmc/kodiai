---
phase: 21-polish
plan: 02
type: execute
wave: 1
depends_on:
  - 21-polish/21-01-SUMMARY.md
files_modified:
  - docs/runbooks/mentions.md
  - docs/smoke/xbmc-xbmc-write-flow.md
autonomous: false
---

<objective>
Run a real-world smoke test of the end-to-end write flow against xbmc/xbmc and document the exact steps and expected outputs, including how to grep evidence bundle logs by deliveryId.
</objective>

<tasks>

<task type="manual">
  <name>Task 1: same-repo PR write-mode updates PR branch</name>
  <files>docs/smoke/xbmc-xbmc-write-flow.md</files>
  <action>
  Use `plan:` then `apply:` on a tiny, safe change in a PR whose head branch is in the base repo.
  Confirm the bot updates the existing PR branch (no bot PR fallback).
  Capture:
  - PR URL
  - trigger comment URL
  - resulting commit/branch update evidence
  - evidence bundle log fields, keyed by deliveryId
  </action>
</task>

<task type="manual">
  <name>Task 2: fork PR write-mode falls back to bot PR</name>
  <files>docs/smoke/xbmc-xbmc-write-flow.md</files>
  <action>
  Use `plan:` then `apply:` on a tiny, safe change in a fork PR.
  Confirm the handler cannot push to fork head and uses bot PR fallback.
  Capture PR URLs (source + bot PR) and the evidence bundle log outcome.
  </action>
</task>

<task type="manual">
  <name>Task 3: guardrails block denied paths and secret-like content</name>
  <files>docs/smoke/xbmc-xbmc-write-flow.md</files>
  <action>
  Attempt writes that should be refused:
  - denied path (e.g. under `.github/`)
  - secret-like content that triggers regex/entropy detection
  Confirm the refusal message reports:
  - rule
  - file/path
  - suggested smallest safe config change (or states none is safe)
  </action>
</task>

<task type="auto">
  <name>Task 4: document evidence bundle grepping by deliveryId</name>
  <files>docs/runbooks/mentions.md</files>
  <action>
  Add a short section showing how to use the GitHub App delivery UI to obtain `X-GitHub-Delivery` and how to grep/query logs for the evidence bundle line.
  </action>
</task>

</tasks>

<verification>
Manual verification per the smoke test doc. No code changes required.
</verification>

<output>
Create `.planning/phases/21-polish/21-02-SUMMARY.md`.
</output>
