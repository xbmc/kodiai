---
phase: 18-observability-verification
plan: 02
type: execute
wave: 2
depends_on:
  - 18-observability-verification/18-01-SUMMARY.md
  - 17-write-mode-reliability/17-02-SUMMARY.md
files_modified:
  - src/handlers/mention.ts
  - src/handlers/review.ts
  - docs/runbooks/mentions.md
  - docs/smoke/xbmc-kodiai-write-flow.md
autonomous: true
---

<objective>
Strengthen observability and release verification for v0.2 by improving grepability and adding lightweight production smoke evidence capture, without introducing external state systems.
</objective>

<tasks>

<task type="auto">
  <name>Task 1: structured log consistency pass</name>
  <files>src/handlers/mention.ts src/handlers/review.ts</files>
  <action>
  Ensure evidence and failure logs use consistent key names for delivery correlation and PR context.
  Keep existing evidence bundle format stable where already used.
  </action>
  <verify>
  - Unit tests continue passing
  </verify>
</task>

<task type="auto">
  <name>Task 2: runbook query snippets for top operator flows</name>
  <files>docs/runbooks/mentions.md</files>
  <action>
  Add concise query snippets for:
  - finding write-mode evidence by deliveryId
  - finding refusal reason patterns
  - finding recheck/rereview request outcomes
  </action>
</task>

<task type="manual">
  <name>Task 3: post-deploy smoke evidence capture template</name>
  <files>docs/smoke/xbmc-kodiai-write-flow.md</files>
  <action>
  Add a tiny template section to record smoke run evidence (PR links + deliveryIds + outcomes) so each release has a repeatable verification artifact.
  </action>
</task>

</tasks>

<verification>
- bun test
- bunx tsc --noEmit
</verification>

<output>
Create `.planning/phases/18-observability-verification/18-02-SUMMARY.md`.
</output>
