---
phase: 75-live-ops-verification-closure
plan: 05
type: execute
wave: 5
depends_on: [75-04]
files_modified:
  - docs/runbooks/review-requested-debug.md
  - docs/smoke/phase75-live-ops-verification-closure.md
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Deterministic closure evidence includes accepted review_requested and explicit @kodiai mention lanes for the same OPS75 matrix run"
    - "Live OPS75 evidence proves exactly one degraded telemetry row per degraded execution identity with duplicate checks passing"
  artifacts:
    - path: "docs/runbooks/review-requested-debug.md"
      provides: "Hard preflight identity gate with explicit SQL pass conditions for review, mention, and degraded identities"
      contains: "OPS75-PREFLIGHT-01"
    - path: "docs/smoke/phase75-live-ops-verification-closure.md"
      provides: "Fresh same-run identity matrix proving review/mention lane rows and degraded row presence before verifier execution"
      contains: "Identity Matrix"
  key_links:
    - from: "docs/runbooks/review-requested-debug.md"
      to: "docs/smoke/phase75-live-ops-verification-closure.md"
      via: "Preflight-selected identities are copied unchanged into the smoke matrix table"
      pattern: "--review|--review-accepted|--mention|--degraded"
    - from: "docs/smoke/phase75-live-ops-verification-closure.md"
      to: "scripts/phase75-live-ops-verification-closure.ts"
      via: "Matrix identity lanes must satisfy verifier preflight and cache/degraded requirements"
      pattern: "OPS75-PREFLIGHT-01|OPS75-CACHE-01|OPS75-CACHE-02|OPS75-ONCE-01"
---

<objective>
Close the identity-capture gaps that are blocking OPS75 by collecting one fresh, preflight-valid matrix for review and mention cache lanes plus degraded executions that truly emitted degraded telemetry rows.

Purpose: Current reruns fail because identities are selected from incomplete telemetry snapshots; this plan makes identity gating and evidence capture deterministic before any closure claim.
Output: Updated runbook and smoke evidence containing a validated same-run identity matrix ready for a release-blocking verifier run.
</objective>

<execution_context>
@/home/keith/.config/opencode/get-shit-done/workflows/execute-plan.md
@/home/keith/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/75-live-ops-verification-closure/75-04-SUMMARY.md
@.planning/phases/75-live-ops-verification-closure/75-VERIFICATION.md
@docs/runbooks/review-requested-debug.md
@docs/smoke/phase75-live-ops-verification-closure.md
@scripts/phase75-live-ops-verification-closure.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Harden OPS75 preflight capture gate for same-run review, mention, and degraded identity readiness</name>
  <files>docs/runbooks/review-requested-debug.md</files>
  <action>
Strengthen the capture gate so identity selection is deterministic and release-safe:

- Require one accepted `review_requested` lane set and one explicit `@kodiai` mention lane set from the same fresh matrix run window.
- Require degraded candidates that each have exactly one `rate_limit_events` row where `degradation_path != none` before they can be sampled.
- Record SQL pass/fail conditions with explicit block reasons and OPS75 check IDs (do not allow soft-pass wording).
- Preserve prior carry-forward rule: non-passing reruns are release blockers and must be documented as blockers, not closure.
  </action>
  <verify>
Run the documented preflight queries and confirm selected identities satisfy lane row count and degraded-row conditions before running `verify:phase75`.
  </verify>
  <done>
Runbook preflight now enforces hard identity readiness gates that prevent incomplete matrix identities from entering OPS75 evidence runs.
  </done>
</task>

<task type="auto">
  <name>Task 2: Capture and publish a fresh OPS75 identity matrix that satisfies preflight gates</name>
  <files>docs/smoke/phase75-live-ops-verification-closure.md</files>
  <action>
Collect a new live matrix and publish only identities that pass Task 1 gates:

- Capture review lane identities (prime/hit/changed) and mention lane identities (prime/hit/changed) that each persist exactly one telemetry row.
- Capture degraded identities that each persist exactly one non-`none` degradation row for the same matrix run period.
- Publish matrix rows and argument-ready identity lists for `--review`, `--review-accepted`, `--mention`, and `--degraded` with no inferred placeholders.
- If any lane or degraded row is missing, record blocker status with exact failed OPS75 check IDs and do not mark phase closure.
  </action>
  <verify>
Confirm the smoke document contains a fresh identity matrix with all lane/degraded prerequisites satisfied and mapped to verifier flags.
  </verify>
  <done>
Smoke evidence contains a complete preflight-valid identity bundle that can drive one deterministic OPS75 verification run.
  </done>
</task>

</tasks>

<verification>
- Preflight SQL checks for review, mention, and degraded identities pass for the same fresh matrix run.
- `docs/runbooks/review-requested-debug.md` encodes hard block conditions tied to OPS75 check IDs.
- `docs/smoke/phase75-live-ops-verification-closure.md` includes argument-ready identity sets for all required verifier flags.
</verification>

<success_criteria>
OPS75 identity selection is no longer the failure source: review and mention cache lanes plus degraded rows are all preflight-valid and explicitly documented before verifier execution.
</success_criteria>

<output>
After completion, create `.planning/phases/75-live-ops-verification-closure/75-05-SUMMARY.md`
</output>
