# v0.22 Issue Intelligence — SHIPPED 2026-02-27

**Milestone Goal:** Populate the issue corpus from historical xbmc/xbmc data, add high-confidence duplicate detection and PR-issue linking, and enable auto-triage on `issues.opened`.

## Stats

- **Phases:** 4 (106-109)
- **Plans:** 7 total (2 + 2 + 2 + 1)
- **Commits:** 10 (since v0.21 tag)
- **Files changed:** 57
- **Lines:** +9,629 / -875
- **Timeline:** 2026-02-27 (single day)
- **Requirements:** 19/19 satisfied (1 gap fixed during audit)

## Key Accomplishments

1. **Historical Corpus Population** — Backfill script ingests all xbmc/xbmc issues (excluding PRs) with Voyage AI embeddings, HNSW-indexed vectors, and cursor-based resume. Nightly sync via GitHub Actions keeps corpus current.

2. **Duplicate Detection & Auto-Triage** — When `issues.opened` fires with auto-triage enabled, the system finds high-confidence duplicate candidates and posts a formatted comment with top-3 matches (similarity scores, titles, status). Never auto-closes. Four-layer idempotency (delivery-ID dedup, atomic DB claim with cooldown, comment marker scan).

3. **PR-Issue Linking** — PRs are linked to related issues via explicit reference parsing (`fixes #N`, `closes #N`, `relates-to`) and semantic search fallback. Linked issue context is injected into review prompts for richer feedback.

4. **Issue Corpus Retrieval Integration** — Issues participate in unified cross-corpus RRF retrieval alongside code, review comments, wiki pages, and snippets. Hybrid search (vector + BM25), per-trigger weight tuning, `[issue: #N] Title (status)` citations.

## Phases

### Phase 106: Historical Corpus Population
**Goal**: The issue corpus contains all xbmc/xbmc issues with embeddings and stays current via nightly sync
**Requirements**: INGEST-01 through INGEST-07
**Plans:**
- 106-01: Migration, comment chunker, and core backfill engine
- 106-02: CLI script with dual-mode backfill/sync and GitHub Actions nightly workflow

### Phase 107: Duplicate Detection & Auto-Triage
**Goal**: New issues are automatically triaged with duplicate detection, surfacing high-confidence duplicates to maintainers
**Requirements**: DUPL-01 through DUPL-04, TRIAGE-01 through TRIAGE-04
**Plans:**
- 107-01: Migration, config extension, duplicate detector, and triage comment formatter
- 107-02: Issue-opened handler with idempotency and application bootstrap wiring

### Phase 108: PR-Issue Linking
**Goal**: PRs are linked to related issues via explicit references and semantic search, enriching review context
**Requirements**: PRLINK-01 through PRLINK-03
**Plans:**
- 108-01: Issue reference parser (pure regex) and issue linker orchestrator
- 108-02: Wire into review pipeline: extend buildReviewPrompt, inject issueStore dep

### Phase 109: Issue Corpus Retrieval Integration
**Goal**: Issue corpus participates in cross-corpus retrieval with citations
**Requirements**: PRLINK-04
**Plans:**
- 109-01: Issue retrieval module, pipeline wiring, and application bootstrap

## Audit

Milestone audit completed 2026-02-27. One gap found and fixed:
- TRIAGE-04: Added `cooldownMinutes` enforcement to `issue-opened.ts` (was missing per-issue cooldown window)

See `v0.22-MILESTONE-AUDIT.md` for full details.
