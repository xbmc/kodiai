# v0.23 Interactive Troubleshooting

**Milestone Goal:** When `@kodiai` is mentioned on an open issue with troubleshooting intent, synthesize targeted guidance grounded in similar resolved issues. Close the feedback loop by capturing issue outcomes, auto-tuning duplicate detection thresholds via Bayesian learning, and tracking triage comment reactions.

**Source:** [Issue #75](https://github.com/xbmc/kodiai/issues/75)

## Phases

### Phase 110: Troubleshooting Retrieval Foundation
**Goal**: The system can retrieve similar resolved issues and assemble resolution-focused thread context for troubleshooting synthesis
**Requirements**: TSHOOT-01, TSHOOT-02, TSHOOT-03
**Plans:**
- 110-01: Extend IssueStore with stateFilter on searchByEmbedding/searchByFullText, thread assembler with tail+semantic priority, wiki fallback path
- 110-02: Integration tests for state-filtered retrieval and thread assembly budget enforcement

### Phase 111: Troubleshooting Agent
**Goal**: `@kodiai` mentions on open issues with troubleshooting intent produce synthesized guidance citing resolved issues
**Requirements**: TSHOOT-04, TSHOOT-05, TSHOOT-06, TSHOOT-07, TSHOOT-08
**Plans:**
- 111-01: Intent classifier (keyword heuristics on mention text + issue title/body), config gate (`triage.troubleshooting.enabled`), comment-scoped marker dedup
- 111-02: Troubleshooting handler (`src/handlers/troubleshooting-agent.ts`) with resolved-issue synthesis, provenance citations, and mention handler wiring

### Phase 112: Outcome Capture
**Goal**: Issue closure events are captured with resolution outcome, linked to triage records, and triage comment GitHub IDs are stored for reaction tracking
**Requirements**: OUTCOME-01, OUTCOME-02, OUTCOME-03, OUTCOME-04, OUTCOME-05, REACT-01
**Plans:**
- 112-01: Migration (issue_outcome_feedback table, comment_github_id on issue_triage_state), issue-closed handler with PR filtering and delivery-ID idempotency
- 112-02: Outcome record creation with confirmed_duplicate detection (state_reason + label fallback), triage linkage, and comment_github_id capture in issue-opened handler

### Phase 113: Threshold Learning
**Goal**: Duplicate detection threshold auto-tunes per repo using Beta-Binomial Bayesian updating from confirmed outcomes
**Requirements**: LEARN-01, LEARN-02, LEARN-03, LEARN-04
**Plans:**
- 113-01: Migration (triage_threshold_state table), Beta-Binomial update function, minimum sample gate (20 outcomes), threshold clamping [50, 95]
- 113-02: Wire duplicate detector to read effective threshold (auto-tuned if available, else config fallback), structured logging on threshold changes

### Phase 114: Reaction Tracking
**Goal**: Triage comment reactions are periodically synced and feed into outcome feedback as a secondary signal
**Requirements**: REACT-02, REACT-03
**Plans:**
- 114-01: Migration (triage_comment_reactions table), nightly sync job polling reactions on recent triage comments, reaction data linkage to outcome feedback

## Dependencies

```
Phase 110 ──→ Phase 111  (retrieval foundation required for agent)
Phase 112 ──→ Phase 113  (outcome capture required for threshold learning)
Phase 112 ──→ Phase 114  (comment_github_id required for reaction polling)
```

Phases 110-111 and 112-114 are independent tracks that can be executed in either order.
