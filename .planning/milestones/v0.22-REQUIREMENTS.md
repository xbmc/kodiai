# Requirements: Kodiai v0.22 Issue Intelligence — ARCHIVED

**Defined:** 2026-02-26
**Completed:** 2026-02-27
**Core Value:** When a PR is opened, `@kodiai` is mentioned on GitHub, or `@kodiai` is addressed in Slack, the bot responds with accurate, actionable code feedback without requiring workflow setup in the target repo.

## v0.22 Requirements — ALL COMPLETE

### Ingestion

- [x] **INGEST-01**: User can run a backfill script that populates the issue corpus with historical xbmc/xbmc issues and their comment threads
- [x] **INGEST-02**: Each backfilled issue is embedded via Voyage AI (title + body) and stored with HNSW-indexed vectors
- [x] **INGEST-03**: Backfill script filters out pull requests returned by the GitHub Issues API
- [x] **INGEST-04**: Backfill script tracks sync state for cursor-based resume on interruption
- [x] **INGEST-05**: Backfill script logs progress with page counts, embedding counts, and rate limit status
- [x] **INGEST-06**: Nightly sync job fetches issues updated since last sync and upserts them with fresh embeddings
- [x] **INGEST-07**: Nightly sync job also syncs new and updated issue comments

### Duplicate Detection

- [x] **DUPL-01**: When a new issue is triaged, the system queries the issue corpus for vector-similar candidates at high-confidence threshold
- [x] **DUPL-02**: Top-3 duplicate candidates are presented in a comment with similarity scores, titles, numbers, and open/closed status
- [x] **DUPL-03**: Duplicate detection never auto-closes issues — it comments and optionally applies a label
- [x] **DUPL-04**: Duplicate detection is fail-open — embedding or search failures are logged but never block triage

### PR Linking

- [x] **PRLINK-01**: PR body and commit messages are parsed for explicit issue references (fixes, closes, relates-to patterns)
- [x] **PRLINK-02**: When no explicit references are found, semantic search finds related issues from the corpus
- [x] **PRLINK-03**: Linked issue context is included in PR review prompts for richer review feedback
- [x] **PRLINK-04**: Issue corpus is wired as a source in cross-corpus RRF retrieval with `[issue: #N]` citations

### Auto-Triage

- [x] **TRIAGE-01**: `issues.opened` webhook event triggers the triage pipeline automatically
- [x] **TRIAGE-02**: Auto-triage is gated behind `triage.autoTriageOnOpen` config flag (default: false)
- [x] **TRIAGE-03**: Auto-triage includes duplicate detection in the triage flow
- [x] **TRIAGE-04**: Auto-triage is idempotent — webhook dedup, in-flight claim, and per-issue cooldown prevent duplicate comments

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| INGEST-01 | Phase 106 | Complete |
| INGEST-02 | Phase 106 | Complete |
| INGEST-03 | Phase 106 | Complete |
| INGEST-04 | Phase 106 | Complete |
| INGEST-05 | Phase 106 | Complete |
| INGEST-06 | Phase 106 | Complete |
| INGEST-07 | Phase 106 | Complete |
| DUPL-01 | Phase 107 | Complete |
| DUPL-02 | Phase 107 | Complete |
| DUPL-03 | Phase 107 | Complete |
| DUPL-04 | Phase 107 | Complete |
| PRLINK-01 | Phase 108 | Complete |
| PRLINK-02 | Phase 108 | Complete |
| PRLINK-03 | Phase 108 | Complete |
| PRLINK-04 | Phase 109 | Complete |
| TRIAGE-01 | Phase 107 | Complete |
| TRIAGE-02 | Phase 107 | Complete |
| TRIAGE-03 | Phase 107 | Complete |
| TRIAGE-04 | Phase 107 | Complete (gap fixed during audit) |

**Coverage:** 19/19 requirements complete (100%)

## Future Requirements (Deferred)

- **CLASS-01**: Automatic area classification labels based on issue content
- **CLASS-02**: Per-repo label taxonomy configuration in `.kodiai.yml`
- **ASSIGN-01**: Suggested assignee based on contributor profiles and area labels

---
*Archived: 2026-02-27*
